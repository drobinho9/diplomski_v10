<!DOCTYPE html>
<html lang="hr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tjedni izvještaj - Fitness App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
        }
        .insight-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            color: white;
            padding: 20px;
            margin-bottom: 15px;
        }
        .progress-ring {
            transform: rotate(-90deg);
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">📊 Vaš tjedni izvještaj</h1>
                <p class="text-muted">Pregled vaše aktivnosti u zadnjih 7 dana</p>
            </div>
        </div>

        <!-- Statistike -->
        <div class="row">
            <div class="col-md-3">
                <div class="stat-card text-center">
                    <div class="stat-number">{{ report.workout_count }}</div>
                    <div>🏋️ Treninzi</div>
                    <small>od preporučenih 4-5</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card text-center">
                    <div class="stat-number">{{ report.avg_daily_calories|int }}</div>
                    <div>🥗 Prosječne kalorije</div>
                    <small>dnevno</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card text-center">
                    <div class="stat-number">{{ report.avg_mood_score }}/5</div>
                    <div>😊 Raspoloženje</div>
                    <small>prosječna ocjena</small>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stat-card text-center">
                    <div class="stat-number">{{ (report.avg_daily_water/1000)|round(1) }}L</div>
                    <div>💧 Prosječna voda</div>
                    <small>dnevno</small>
                </div>
            </div>
        </div>

        <!-- Uvidi i preporuke -->
        <div class="row mt-4">
            <div class="col-12">
                <h3>💡 Personalizirani uvidi</h3>
                {% for insight in insights %}
                <div class="insight-card">
                    {{ insight }}
                </div>
                {% endfor %}
            </div>
        </div>

        <!-- Napredak prema cilju -->
        <div class="row mt-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h4>🎯 Napredak prema vašem cilju:
                            {% if user.goal == 'weight_loss' %}
                                Gubitak težine
                            {% elif user.goal == 'muscle_gain' %}
                                Gradnja mišića
                            {% else %}
                                Održavanje težine
                            {% endif %}
                        </h4>
                    </div>
                    <div class="card-body">
                        {% if user.goal == 'weight_loss' %}
                            <div class="alert alert-info">
                                <strong>Status:</strong>
                                {% if report.workout_count >= 4 and report.avg_daily_calories < 2000 %}
                                    ✅ Na dobrom ste putu! Održavate dobru kombinaciju treninga i ishrane.
                                {% else %}
                                    ⚠️ Preporučujemo više kardio treninga i praćenje kalorija.
                                {% endif %}
                            </div>
                        {% elif user.goal == 'muscle_gain' %}
                            <div class="alert alert-success">
                                <strong>Status:</strong>
                                {% if report.workout_count >= 3 and report.avg_daily_calories > 2200 %}
                                    ✅ Odlično! Dovoljno treninga snage i kalorija za rast.
                                {% else %}
                                    ⚠️ Možda trebate više treninga snage i kalorija.
                                {% endif %}
                            </div>
                        {% else %}
                            <div class="alert alert-warning">
                                <strong>Status:</strong>
                                {% if report.workout_count >= 2 %}
                                    ✅ Dobro održavate aktivnost!
                                {% else %}
                                    ⚠️ Dodajte više aktivnosti za bolju kondiciju.
                                {% endif %}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Akcijski gumbovi (ISPRAVLJENO) -->
        <div class="row mt-4">
            <div class="col-12 text-center">
                <a href="{{ url_for('main.dashboard') }}" class="btn btn-primary me-2">🏠 Povratak na početnu</a>

                <form method="POST" action="{{ url_for('main.generate_plan') }}" class="d-inline">
                    <button type="submit" class="btn btn-success me-2">🏋️ Novi plan treninga</button>
                </form>

                <form method="POST" action="{{ url_for('main.get_meals') }}" class="d-inline">
                     <button type="submit" class="btn btn-warning">🥗 Preporuke hrane</button>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
